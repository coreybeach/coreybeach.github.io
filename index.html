<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cruise Master Plan</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#101a2e;
      --card2:#0f172a;
      --text:#e5e7eb;
      --muted:#a6b0c3;
      --accent:#60a5fa;
      --accent2:#34d399;
      --warn:#fbbf24;
      --danger:#f87171;
      --border:rgba(255,255,255,.08);
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(900px 600px at 20% -10%, rgba(96,165,250,.22), transparent 55%),
                  radial-gradient(900px 600px at 80% 0%, rgba(52,211,153,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.35;
    }
    a{color:inherit; text-decoration:none}
    .wrap{max-width:1100px; margin:0 auto; padding:16px 14px 70px;}

    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: rgba(11,18,32,.72);
      border-bottom: 1px solid var(--border);
    }
    .topbar-inner{
      max-width:1100px; margin:0 auto; padding:12px 14px;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
    }
    .brand{display:flex; flex-direction:column; gap:2px;}
    .brand .title{font-weight:800; letter-spacing:.2px}
    .brand .sub{color:var(--muted); font-size:12px}
    .nav{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;}
    .pill{
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--border);
      background: rgba(16,26,46,.65);
      font-size:13px;
      transition:.15s transform ease, .15s background ease;
      white-space:nowrap;
    }
    .pill:active{transform: scale(.98)}
    .pill:hover{background: rgba(16,26,46,.9)}
    .pill.accent{border-color: rgba(96,165,250,.35)}

    section{margin-top:18px}
    .section-head{
      display:flex; align-items:flex-end; justify-content:space-between; gap:10px; margin:8px 0 10px;
    }
    h2{margin:0; font-size:18px; letter-spacing:.2px;}
    .note{color:var(--muted); font-size:12px;}

    .grid{display:grid; grid-template-columns: 1fr; gap:12px;}
    @media (min-width: 860px){
      .grid.two{grid-template-columns: 1fr 1fr}
    }
    .card{
      background: linear-gradient(180deg, rgba(16,26,46,.92), rgba(15,23,42,.92));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px 14px 12px;
    }
    .card h3{margin:0 0 8px; font-size:15px;}
    .kv{display:flex; gap:10px; flex-wrap:wrap; color:var(--muted); font-size:12px;}
    .chip{
      padding:6px 10px; border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
    }
    .list{margin:10px 0 0; padding:0; list-style:none; display:flex; flex-direction:column; gap:8px;}
    .li{padding:10px 10px; border-radius: 12px; background: rgba(255,255,255,.03); border:1px solid var(--border);}
    .li .when{font-family:var(--mono); color:#cdd6e7; font-size:12px}
    .li .what{margin-top:2px}
    .tag{
      display:inline-block; font-size:11px; padding:3px 8px; border-radius:999px;
      margin-left:8px; border:1px solid var(--border); color:var(--muted); vertical-align:middle;
    }
    .tag.priority{color:#0b1220; background: var(--warn); border-color: rgba(251,191,36,.35)}
    .tag.locked{color:#0b1220; background: var(--accent2); border-color: rgba(52,211,153,.35)}
    .tag.flex{color:#0b1220; background: var(--warn); border-color: rgba(251,191,36,.35)}
    .tag.risk{color:#0b1220; background: var(--danger); border-color: rgba(248,113,113,.35)}

    .daybar{
      display:flex; gap:8px; overflow:auto; padding-bottom:6px;
      -webkit-overflow-scrolling: touch; scrollbar-width: none;
    }
    .daybar::-webkit-scrollbar{display:none}
    .daybtn{
      flex: 0 0 auto;
      padding: 10px 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(16,26,46,.75);
      color: #e5e7eb;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      user-select: none;
      transition:
        background .15s ease,
        transform .15s ease,
        color .15s ease,
        box-shadow .15s ease;
    }
    .daybtn:hover{background: rgba(16,26,46,.95); color:#fff;}
    .daybtn:active{transform: scale(.97);}
    .daybtn.active{
      color: #ffffff;
      background: linear-gradient(180deg, rgba(96,165,250,.35), rgba(59,130,246,.35));
      border-color: rgba(96,165,250,.6);
      box-shadow: 0 0 0 2px rgba(96,165,250,.25) inset;
    }

    .timeline{margin-top:10px}
    .daypanel{display:none}
    .daypanel.active{display:block}

    .table-wrap{
      overflow:auto;
      border-radius: var(--radius);
      border:1px solid var(--border);
      background: rgba(16,26,46,.55);
    }
    table{
      width:100%;
      border-collapse: collapse;
      min-width: 980px;
    }
    th, td{
      border-bottom:1px solid var(--border);
      border-right:1px solid var(--border);
      padding:10px 10px;
      vertical-align: top;
      font-size:13px;
    }
    th{
      position:sticky; top:0;
      background: rgba(11,18,32,.95);
      z-index:1;
      text-align:left;
      font-size:12px;
      letter-spacing:.2px;
      color: var(--muted);
    }
    td:first-child, th:first-child{
      position:sticky; left:0;
      background: rgba(11,18,32,.95);
      z-index:2;
      font-family: var(--mono);
      font-size:12px;
      color:#cdd6e7;
      width:120px;
    }
    tr:last-child td{border-bottom:none}
    td:last-child, th:last-child{border-right:none}
    .cell-muted{color: var(--muted)}
    .small{font-size:12px; color: var(--muted)}
    .footer{margin-top:18px; color: var(--muted); font-size:12px; text-align:center;}
    .kbd{font-family:var(--mono); font-size:12px; padding:2px 6px; border:1px solid var(--border); border-radius:8px; background: rgba(255,255,255,.03)}
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="title">ğŸ›³ï¸ Cruise Master Plan</div>
        <div class="sub" id="subtitle">All times = ship time â€¢ Offline-friendly</div>
      </div>
      <nav class="nav">
        <a class="pill accent" href="#today">Today</a>
        <a class="pill" href="#glance">At-a-glance</a>
        <a class="pill" href="#grid">Visual grid</a>
        <a class="pill" href="#days">Days</a>
      </nav>
    </div>
  </div>

  <div class="wrap">
    <!-- TODAY -->
    <section id="today">
      <div class="section-head">
        <h2>ğŸ“Œ Today (tap a day below)</h2>
        <div class="note">Edit the JSON once â†’ page updates everywhere.</div>
      </div>

      <div class="card">
        <div class="daybar" id="daybar" role="tablist" aria-label="Select day"></div>
        <div class="timeline" id="todayPanels"></div>
      </div>
    </section>

    <!-- AT A GLANCE -->
    <section id="glance">
      <div class="section-head">
        <h2>ğŸ‘€ At-a-Glance</h2>
        <div class="note">Fast decisions without scrolling a full timeline.</div>
      </div>

      <div class="grid two">
        <div class="card">
          <h3>ğŸ­ Entertainment</h3>
          <ul class="list" id="glanceEntertainment"></ul>
        </div>

        <div class="card">
          <h3>ğŸï¸ Ports & Excursions</h3>
          <ul class="list" id="glancePorts"></ul>
        </div>
      </div>

      <div class="grid two" style="margin-top:12px">
        <div class="card">
          <h3>ğŸ½ï¸ Dining</h3>
          <ul class="list" id="glanceDining"></ul>
        </div>

        <div class="card">
          <h3>âš ï¸ Risk & Energy</h3>
          <ul class="list" id="glanceRisk"></ul>
        </div>
      </div>

      <div class="note" style="margin-top:10px">
        Tip: If you edit times, keep <span class="kbd">start</span>/<span class="kbd">end</span> in <span class="kbd">HH:MM</span> (24-hour) so sorting stays correct.
      </div>
    </section>

    <!-- VISUAL GRID -->
    <section id="grid">
      <div class="section-head">
        <h2>ğŸ—“ï¸ Visual Grid</h2>
        <div class="note">Scroll horizontally on phone â€¢ sticky headers + time column.</div>
      </div>

      <div class="table-wrap">
        <table aria-label="Visual schedule grid">
          <thead>
            <tr id="gridHead"></tr>
          </thead>
          <tbody id="gridBody"></tbody>
        </table>
      </div>
    </section>

    <!-- DAYS -->
    <section id="days">
      <div class="section-head">
        <h2>ğŸ“… Full Day-by-Day</h2>
        <div class="note">Same data as the grid + logistics.</div>
      </div>

      <div class="grid two" id="dayCards"></div>

      <div class="footer">
        Tip: iPhone Safari â†’ Share â†’ â€œAdd to Home Screenâ€. Android Chrome â†’ Menu â†’ â€œAdd to Home screenâ€.
      </div>
    </section>
  </div>

  <!-- ===========================
       EDIT THIS JSON ONLY
       =========================== -->
  <script>
  const CRUISE_DATA = {
  meta: {
    subtitle: "All times = ship time â€¢ Offline-friendly",
    days: [
      { id:"d1", label:"Day 1", title:"Miami / Sail Away" },
      { id:"d2", label:"Day 2", title:"Sea Day" },
      { id:"d3", label:"Day 3", title:"Puerto Costa Maya (8:00â€“5:00)" },
      { id:"d4", label:"Day 4", title:"RoatÃ¡n (7:00â€“4:00)" },
      { id:"d5", label:"Day 5", title:"Cozumel (8:00â€“6:00)" },
      { id:"d6", label:"Day 6", title:"Sea Day" },
      { id:"d7", label:"Day 7", title:"CocoCay (7:00â€“5:00)" }
    ]
  },

  glance: {
    dining: [
      { day:"Day 1", text:"ğŸŸ¨ğŸ½ï¸ Flexible (6:30â€“?)", tags:["flex"] },
      { day:"Day 2", text:"ğŸ½ï¸ğŸ”’ Booked (6:45â€“?)", tags:["locked"] },
      { day:"Day 3", text:"ğŸŸ¨ğŸ½ï¸ Shifted placeholder (7:00â€“?)", tags:["flex"] },
      { day:"Day 4", text:"ğŸ½ï¸ğŸ”’ Booked (6:45â€“?)", tags:["locked"] },
      { day:"Day 5", text:"ğŸ½ï¸ğŸ”’ Booked (8:30â€“?)", tags:["locked"] },
      { day:"Day 6", text:"ğŸŸ¨ğŸ½ï¸ Flexible (6:30â€“?)", tags:["flex"] },
      { day:"Day 7", text:"ğŸŸ¨ğŸ½ï¸ Post-Starburst dining (after ~8:15)", tags:["flex"] }
    ],
    ports: [
      { day:"Day 3", text:"Puerto Costa Maya (8:00â€“5:00) â€” Explore" },
      { day:"Day 4", text:"RoatÃ¡n (7:00â€“4:00) â€” ğŸ§—â€â™‚ï¸ Zipline 9:00 (meet ~8:30)" },
      { day:"Day 5", text:"Cozumel (8:00â€“6:00) â€” ğŸ› ATV + Jade Caverns 10:00 (ready ~9:30)" },
      { day:"Day 7", text:"CocoCay (7:00â€“5:00) â€” Chill day" }
    ],
    entertainment: [
      { day:"Day 1", text:"ğŸ­ Headliner (9:30â€“10:20) â€¢ ğŸ¶ Sing-Along (11:50â€“12:00) â€¢ ğŸ‰ Balloon Drop/DJ (12:00â€“Late)" },
      { day:"Day 2", text:"ğŸ¤ Adult Comedy (11:30â€“12:25)" },
      { day:"Day 3", text:"ğŸ­ Wizard of Oz (4:30â€“6:10) â€¢ ğŸ¤ Adult Comedy (11:30â€“12:25)" },
      { day:"Day 4", text:"ğŸ® Love & Marriage (9:00â€“10:00)", tags:["priority"] },
      { day:"Day 5", text:"ğŸ® Price Is Right (7:00â€“8:00) â€¢ ğŸ® Crazy Quest (11:00â€“11:45)", tags:["priority"] },
      { day:"Day 6", text:"ğŸ’¦ Aqua Action (10:30â€“11:30)" },
      { day:"Day 7", text:"âœ¨ Starburst (7:15â€“~8:05) â€¢ ğŸ¤ Adult Comedy (10:30â€“11:25)" }
    ],
    risk: [
      { label:"Early mornings", text:"Day 4 (Zipline) â€¢ Day 5 (ATV)" },
      { label:"Late-night risk", text:"Day 1 (past midnight) â€¢ Day 3 (comedy ends 12:25 â†’ early excursion)", tags:["risk"] },
      { label:"High-energy days", text:"Day 4 â€¢ Day 5" },
      { label:"Recovery days", text:"Day 2 â€¢ Day 6 â€¢ Day 7 (choose chill)" },
      { label:"Best to book more", text:"Day 2 â€¢ Day 6 (Sea Days)" }
    ]
  },

  days: {
    d1: {
      chips: ["ğŸ“ Miami â†’ Sail Away", "ğŸ½ï¸ ğŸŸ¨ Flexible (6:30â€“?)", "ğŸ§¯ Safety briefing required"],
      events: [
        { start:"16:30", end:"17:00", title:"ğŸ‰ Sail Away Party", venue:"Pool Deck D16" },
        { start:"18:30", end:null, title:"ğŸŸ¨ğŸ½ï¸ My Time Dining", tags:["flex"] },
        { start:"21:30", end:"22:20", title:"ğŸ­ Headliner", venue:"Royal Theater D4" },
        { start:"23:50", end:"24:00", title:"ğŸ¶ Sing-Along", venue:"Promenade D5" },
        { start:"24:00", end:null, title:"ğŸ‰ Balloon Drop + DJ", venue:"Promenade D5 / Music Hall D3" }
      ]
    },

    d2: {
      chips: ["ğŸŒŠ Sea Day", "ğŸ½ï¸ğŸ”’ 6:45â€“?"],
      events: [
        { start:"18:45", end:null, title:"ğŸ½ï¸ğŸ”’ My Time Dining", tags:["locked"] },
        { start:"23:30", end:"24:25", title:"ğŸ¤ Adult Comedy (18+)", venue:"The Attic D6" }
      ]
    },

    d3: {
      chips: ["ğŸï¸ Puerto Costa Maya (8:00â€“5:00)", "ğŸŸ¨ğŸ½ï¸ Dining shifted (7:00â€“?)", "âš ï¸ Late-night risk"],
      events: [
        { start:"08:00", end:"17:00", title:"ğŸï¸ Port day (explore)" },
        { start:"16:30", end:"18:10", title:"ğŸ­ Wizard of Oz", venue:"Royal Theater D4" },
        { start:"19:00", end:null, title:"ğŸŸ¨ğŸ½ï¸ My Time Dining", tags:["flex"] },
        { start:"23:30", end:"24:25", title:"ğŸ¤ Adult Comedy (18+)", venue:"The Attic D6", tags:["risk"] }
      ]
    },

    d4: {
      chips: ["ğŸï¸ RoatÃ¡n (7:00â€“4:00)", "ğŸ§—â€â™‚ï¸ Zipline 9:00 (meet ~8:30)", "ğŸ½ï¸ğŸ”’ 6:45â€“?"],
      events: [
        { start:"08:30", end:null, title:"â±ï¸ Be at pickup/meet location" },
        { start:"09:00", end:null, title:"ğŸ§—â€â™‚ï¸ Zipline Excursion (port)" },
        { start:"18:45", end:null, title:"ğŸ½ï¸ğŸ”’ My Time Dining", tags:["locked"] },
        { start:"21:00", end:"22:00", title:"ğŸ® Love & Marriage", venue:"Royal Theater D4", tags:["priority"] }
      ]
    },

    d5: {
      chips: ["ğŸï¸ Cozumel (8:00â€“6:00)", "ğŸ› ATV 10:00 (ready ~9:30)", "ğŸ½ï¸ğŸ”’ 8:30â€“?"],
      events: [
        { start:"09:30", end:null, title:"â±ï¸ Ready/meeting buffer" },
        { start:"10:00", end:null, title:"ğŸ› ATV + Jade Caverns Excursion" },
        { start:"19:00", end:"20:00", title:"ğŸ® Price Is Right", venue:"Royal Theater D4", tags:["priority"] },
        { start:"20:30", end:null, title:"ğŸ½ï¸ğŸ”’ My Time Dining", tags:["locked"] },
        { start:"23:00", end:"23:45", title:"ğŸ® Crazy Quest", venue:"Absolute Zero D6", tags:["priority"] }
      ]
    },

    d6: {
      chips: ["ğŸŒŠ Sea Day", "ğŸŸ¨ğŸ½ï¸ Flexible (6:30â€“?)"],
      events: [
        { start:"18:30", end:null, title:"ğŸŸ¨ğŸ½ï¸ My Time Dining", tags:["flex"] },
        { start:"22:30", end:"23:30", title:"ğŸ’¦ Aqua Action", venue:"AquaTheater D15" }
      ]
    },

    d7: {
      chips: ["ğŸï¸ CocoCay (7:00â€“5:00)", "âœ¨ Starburst @ 7:15", "ğŸŸ¨ğŸ½ï¸ Dining after Starburst"],
      events: [
        { start:"07:00", end:"17:00", title:"ğŸï¸ Island day" },
        { start:"19:15", end:"20:05", title:"âœ¨ Starburst: Elemental Beauty", venue:"Absolute Zero D6" },
        { start:"20:15", end:null, title:"ğŸŸ¨ğŸ½ï¸ Dinner (post-Starburst placeholder)", tags:["flex"] },
        { start:"22:30", end:"23:25", title:"ğŸ¤ Adult Comedy (18+)", venue:"Royal Theater D4" }
      ]
    }
  },

  gridSlots: [
    { label:"4:30â€“6:10", start:"16:30", end:"18:10" },
    { label:"6:30â€“9:30", start:"18:30", end:"21:30" },
    { label:"7:00â€“8:00", start:"19:00", end:"20:00" },
    { label:"8:30â€“?", start:"20:30", end:null },
    { label:"9:00â€“10:00", start:"21:00", end:"22:00" },
    { label:"9:30â€“10:20", start:"21:30", end:"22:20" },
    { label:"10:30â€“11:30", start:"22:30", end:"23:30" },
    { label:"11:00â€“11:45", start:"23:00", end:"23:45" },
    { label:"11:30â€“12:25", start:"23:30", end:"24:25" },
    { label:"11:50â€“12:00", start:"23:50", end:"24:00" },
    { label:"12:00â€“Late", start:"24:00", end:null }
  ],

  debark: {
    when:"Jan 31 â€¢ 6:00 AM",
    text:"ğŸ§³ Arrive Miami â€” plan bags/exit timing accordingly"
  }
};

  </script>

  <script>
    // ---------- Helpers ----------
    function pad2(n){ return String(n).padStart(2,"0"); }

    // Converts "24:00" to minutes (1440). Accepts "HH:MM"
    function toMins(hhmm){
      if(!hhmm) return null;
      const [h,m] = hhmm.split(":").map(Number);
      return (h*60)+m;
    }

    // Converts minutes back to 12h display; handles >= 1440 as next day
    function fmtTime(hhmm){
      if(!hhmm) return "";
      const [hRaw, m] = hhmm.split(":").map(Number);
      let mins = (hRaw*60)+m;
      mins = mins % 1440;
      let h = Math.floor(mins/60);
      const mm = mins % 60;
      const ampm = h >= 12 ? "PM" : "AM";
      h = h % 12; if(h === 0) h = 12;
      return `${h}:${pad2(mm)} ${ampm}`;
    }

    function fmtRange(start, end){
      if(!start && !end) return "";
      if(start && !end) return `${fmtTime(start)}â€“?`;
      if(start && end) return `${fmtTime(start)}â€“${fmtTime(end)}`;
      return "";
    }

    function tagSpan(tag){
      if(!tag) return "";
      return `<span class="tag ${tag}">${tag === "priority" ? "PRIORITY" : tag === "locked" ? "Booked" : tag === "flex" ? "Flexible" : tag === "risk" ? "Risk" : tag}</span>`;
    }

    function renderGlanceList(el, items, mode){
      el.innerHTML = items.map(it => {
        const left = it.day || it.label || "";
        const tags = (it.tags || []).map(tagSpan).join("");
        return `
          <li class="li">
            <div class="when">${left}</div>
            <div class="what">${it.text || ""} ${tags}</div>
          </li>
        `;
      }).join("");
    }

    function sortEvents(events){
      return [...events].sort((a,b) => (toMins(a.start)||0) - (toMins(b.start)||0));
    }

    function renderEventLI(ev){
      const when = fmtRange(ev.start, ev.end);
      const tags = (ev.tags || []).map(tagSpan).join("");
      const venue = ev.venue ? `<span class="tag">${ev.venue}</span>` : "";
      return `
        <li class="li">
          <div class="when">${when || "â€”"}</div>
          <div class="what">${ev.title} ${tags} ${venue}</div>
        </li>
      `;
    }

    // Find event(s) whose start falls within the slot, or overlap the slot.
    function eventsForSlot(dayEvents, slot){
      const s0 = toMins(slot.start);
      const s1 = slot.end ? toMins(slot.end) : null;

      return dayEvents.filter(ev => {
        const e0 = toMins(ev.start);
        const e1 = ev.end ? toMins(ev.end) : null;

        if(e0 == null) return false;
        // slot is open-ended: match exact start time
        if(s1 == null) return e0 === s0;
        // event has no end: treat as point-in-time, match start inside slot
        if(e1 == null) return (e0 >= s0 && e0 < s1);
        // overlap check
        return (e0 < s1) && (e1 > s0);
      });
    }

    // ---------- Render ----------
    (function init(){
      // subtitle
      document.getElementById("subtitle").textContent = CRUISE_DATA.meta.subtitle;

      // Day buttons + panels
      const daybar = document.getElementById("daybar");
      const todayPanels = document.getElementById("todayPanels");

      CRUISE_DATA.meta.days.forEach((d, idx) => {
        const btn = document.createElement("button");
        btn.className = "daybtn" + (idx === 0 ? " active" : "");
        btn.textContent = d.label;
        btn.dataset.day = d.id;
        daybar.appendChild(btn);

        const panel = document.createElement("div");
        panel.className = "daypanel" + (idx === 0 ? " active" : "");
        panel.id = d.id;

        const dayData = CRUISE_DATA.days[d.id];
        const chips = (dayData?.chips || []).map(c => `<span class="chip">${c}</span>`).join("");
        const evs = sortEvents(dayData?.events || []);
        panel.innerHTML = `
          <div class="kv">${chips}</div>
          <ul class="list">${evs.map(renderEventLI).join("")}</ul>
        `;
        todayPanels.appendChild(panel);
      });

      // Day switching
      const buttons = Array.from(document.querySelectorAll('.daybtn'));
      const panels  = Array.from(document.querySelectorAll('.daypanel'));
      function setDay(id){
        buttons.forEach(b => b.classList.toggle('active', b.dataset.day === id));
        panels.forEach(p => p.classList.toggle('active', p.id === id));
        history.replaceState(null, '', '#today');
      }
      buttons.forEach(b => b.addEventListener('click', () => setDay(b.dataset.day)));

      // At-a-glance lists
      renderGlanceList(document.getElementById("glanceEntertainment"), CRUISE_DATA.glance.entertainment);
      renderGlanceList(document.getElementById("glancePorts"), CRUISE_DATA.glance.ports);
      renderGlanceList(document.getElementById("glanceDining"), CRUISE_DATA.glance.dining);
      renderGlanceList(document.getElementById("glanceRisk"), CRUISE_DATA.glance.risk);

      // Grid header
      const gridHead = document.getElementById("gridHead");
      gridHead.innerHTML = `
        <th>Time Block</th>
        ${CRUISE_DATA.meta.days.map(d => `<th>${d.label}</th>`).join("")}
      `;

      // Grid body
      const gridBody = document.getElementById("gridBody");
      const dayIds = CRUISE_DATA.meta.days.map(d => d.id);

      gridBody.innerHTML = CRUISE_DATA.gridSlots.map(slot => {
        const tds = dayIds.map(id => {
          const dayEvents = CRUISE_DATA.days[id]?.events || [];
          const hits = eventsForSlot(dayEvents, slot);
          if(!hits.length) return `<td class="cell-muted">â€”</td>`;

          // If multiple events overlap the same slot, list them stacked
          const content = hits
            .sort((a,b)=> (toMins(a.start)||0)-(toMins(b.start)||0))
            .map(ev => {
              const range = `(${fmtRange(ev.start, ev.end)})`;
              const venue = ev.venue ? `<div class="small">ğŸ“${ev.venue}</div>` : "";
              // Title already includes emoji; keep it clean
              return `<div>${ev.title} ${range}${venue}</div>`;
            })
            .join("<div style='height:8px'></div>");
          return `<td>${content}</td>`;
        }).join("");

        return `<tr><td>${slot.label}</td>${tds}</tr>`;
      }).join("");

      // Full day-by-day cards (plus debark)
      const dayCards = document.getElementById("dayCards");
      const cards = CRUISE_DATA.meta.days.map(d => {
        const dayData = CRUISE_DATA.days[d.id];
        const evs = sortEvents(dayData?.events || []);
        return `
          <div class="card">
            <h3>${d.label} â€“ ${d.title}</h3>
            <ul class="list">${evs.map(renderEventLI).join("")}</ul>
          </div>
        `;
      });

      cards.push(`
        <div class="card">
          <h3>ğŸ§³ Debarkation</h3>
          <ul class="list">
            <li class="li">
              <div class="when">${CRUISE_DATA.debark.when}</div>
              <div class="what">${CRUISE_DATA.debark.text}</div>
            </li>
          </ul>
        </div>
      `);

      dayCards.innerHTML = cards.join("");
    })();
  </script>
</body>
</html>
